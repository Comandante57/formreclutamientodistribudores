<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro Power Labz Crew</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        /* --- 1. Configuraci√≥n Global y Reseteo --- */
        :root {
            --bg-color: #121212;
            --primary-green: #00ff88;
            --dark-green: #00cc66;
            --text-color: #f0f0f0;
            --text-muted: #888;
            --card-bg: #1a1a1a;
            --input-bg: #222;
            --border-color: #333;
            --error-red: #ff6b6b;
            --gradient: linear-gradient(90deg, var(--primary-green), var(--dark-green));
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html, body {
            width: 100%;
            height: 100%;
            overflow-x: hidden;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            /* Espacio para el footer fijo */
            padding-bottom: 80px; 
        }

        /* --- 2. Contenedor Principal y Pantallas --- */
        .app-container {
            width: 100%;
            max-width: 700px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: calc(100vh - 80px); /* Resta el padding del footer */
            flex-grow: 1;
        }

        .screen {
            display: none; /* Oculto por defecto */
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 100%;
            text-align: center;
            animation: fadeIn 0.5s ease-in-out;
        }

        /* La pantalla activa se muestra como flex */
        .screen.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- 3. Tipograf√≠a y Elementos Comunes --- */
        h1 {
            font-size: 3rem;
            font-weight: 900;
            margin-bottom: 10px;
            line-height: 1.1;
        }

        h2 {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 25px;
            color: var(--text-color);
        }

        p, label {
            font-size: 1.1rem;
            line-height: 1.6;
            color: var(--text-muted);
        }

        .subtitle {
            font-size: 1.25rem;
            color: var(--text-muted);
            margin-bottom: 40px;
        }

        .highlight {
            color: var(--primary-green);
        }

        .btn {
            background: var(--gradient);
            color: var(--bg-color);
            border: none;
            border-radius: 50px;
            padding: 18px 40px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            text-decoration: none;
            display: inline-block;
            margin-top: 20px;
            width: 100%; /* Botones ocupan todo el ancho en m√≥vil */
            max-width: 350px; /* L√≠mite en desktop */
        }

        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(0, 255, 136, 0.2);
        }

        .btn:disabled {
            background: var(--border-color);
            color: var(--text-muted);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* --- 4. Barra de Progreso --- */
        .progress-container {
            width: 100%;
            height: 12px;
            background-color: var(--input-bg);
            border-radius: 10px;
            margin-bottom: 40px;
            overflow: hidden;
        }

        .progress-bar {
            width: 0%; /* Controlado por JS */
            height: 100%;
            background: var(--gradient);
            border-radius: 10px;
            transition: width 0.5s ease-out;
        }

        /* --- 5. Tarjeta Interactiva (para Beneficios y Formulario) --- */
        .interactive-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 30px;
            width: 100%;
            min-height: 250px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border: 1px solid var(--border-color);
            margin-bottom: 30px;
            text-align: left; /* Alineado a la izquierda para el formulario */
        }
        
        #benefit-text {
            font-size: 1.3rem;
            color: var(--text-color);
            font-weight: 500;
            transition: opacity 0.3s ease;
            text-align: center; /* Centrado para beneficios */
        }
        
        /* --- 6. Pantalla Formulario (Estilo Did√°ctico) --- */
        #form-step-label {
            display: block;
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-color);
            margin-bottom: 20px;
        }

        #form-step-label .label-icon {
            display: inline-block;
            margin-right: 8px;
            color: var(--primary-green);
        }

        #form-step-input-container {
            width: 100%;
        }

        input[type="text"],
        input[type="number"],
        select {
            width: 100%;
            font-family: 'Inter', sans-serif;
            font-size: 1.1rem;
            padding: 14px 16px;
            background-color: var(--input-bg);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            color: var(--text-color);
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        select:focus {
            outline: none;
            border-color: var(--primary-green);
            box-shadow: 0 0 10px rgba(0, 255, 136, 0.2);
        }

        /* Estilo para placeholder de select */
        select {
            color: var(--text-muted);
        }
        select.has-value {
            color: var(--text-color);
        }
        option {
            background-color: var(--input-bg);
            color: var(--text-color);
        }


        /* Ocultar flechas en input number */
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { 
            -webkit-appearance: none; 
            margin: 0; 
        }
        input[type=number] {
            -moz-appearance: textfield;
        }
        
        .step-validation-message {
            color: var(--error-red);
            font-size: 0.95rem;
            text-align: left;
            margin-top: 15px;
            min-height: 20px;
            font-weight: 500;
            width: 100%;
        }

        /* --- 7. Pantalla Final (Aceptado y Rechazado) --- */
        .final-text {
            font-size: 1.2rem;
            color: var(--text-muted);
            margin: 20px 0;
            max-width: 500px;
        }

        .final-text strong {
            display: block;
            font-size: 1.5rem;
            color: var(--text-color);
            margin: 10px 0;
        }

        .final-text .date {
            color: var(--primary-green);
            font-weight: 700;
        }

        /* --- 8. Footer Fijo --- */
        footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: #000;
            border-top: 1px solid var(--border-color);
            text-align: center;
            padding: 20px;
            z-index: 100;
        }

        footer p {
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        /* --- 9. Responsive --- */
        @media (max-width: 600px) {
            h1 {
                font-size: 2.5rem;
            }
            h2 {
                font-size: 1.8rem;
            }
            .subtitle {
                font-size: 1.1rem;
            }
            .app-container {
                padding: 15px;
                min-height: calc(100vh - 75px); /* Ajuste para footer m√°s peque√±o */
            }
            body {
                padding-bottom: 75px;
            }
            .interactive-card {
                padding: 25px;
                min-height: 200px;
            }
            #benefit-text {
                font-size: 1.15rem;
            }
            #form-step-label {
                font-size: 1.1rem;
            }
            footer {
                padding: 15px;
            }
            footer p {
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>

    <div class="app-container">

        <!-- ======================================= -->
        <!-- == PANTALLA 1: BIENVENIDA              == -->
        <!-- ======================================= -->
        <section class="screen active" id="welcome-screen">
            <h1>Bienvenidos a <span class="highlight">Power Labz</span></h1>
            <p class="subtitle">Completa el formulario para registrarte en el CREW</p>
            <button class="btn" id="start-btn">Completar el formulario</button>
        </section>

        <!-- ======================================= -->
        <!-- == PANTALLA 2: BENEFICIOS            == -->
        <!-- ======================================= -->
        <section class="screen" id="benefits-screen">
            <div class="progress-container">
                <div class="progress-bar" id="progress-benefits"></div>
            </div>
            <h2>Beneficios del CREW</h2>
            <div class="interactive-card">
                <p id="benefit-text">Cargando...</p>
            </div>
            <button class="btn" id="next-benefit-btn">Continuar</button>
        </section>

        <!-- ======================================= -->
        <!-- == PANTALLA 3: REGISTRO              == -->
        <!-- ======================================= -->
        <section class="screen" id="form-screen">
            <div class="progress-container">
                <div class="progress-bar" id="progress-form"></div>
            </div>
            <h2>Tu Registro</h2>
            
            <div class="interactive-card" id="form-card">
                <label for="current-input" id="form-step-label">Cargando...</label>
                <div id="form-step-input-container">
                    <!-- El input o select se inyectar√° aqu√≠ -->
                </div>
                <div class="step-validation-message" id="step-validation"></div>
            </div>
            
            <button class="btn" id="form-next-btn">Siguiente</button>
        </section>

        <!-- ======================================= -->
        <!-- == PANTALLA 4: FINAL (ACEPTADO)      == -->
        <!-- ======================================= -->
        <section class="screen" id="final-screen">
            <div class="progress-container">
                <div class="progress-bar" id="progress-final-accept"></div>
            </div>
            <h2>¬°<span class="highlight">FELICIDADES!</span><br>YA CASI EST√ÅS DENTRO</h2>
            <p class="final-text">
                Tu primer paquete de patrocinio se enviar√° a partir del <strong class="date" id="current-date-span">[FECHA ACTUAL]</strong>
                Env√≠anos un mensaje para confirmar tu lugar y coordinar tu primer env√≠o.
            </p>
            <button class="btn" id="whatsapp-btn">Recibir mi patrocinio ahora</button>
        </section>

        <!-- ======================================= -->
        <!-- == N U E V O: PANTALLA 5: FINAL (RECHAZO) == -->
        <!-- ======================================= -->
        <section class="screen" id="rejection-screen">
            <div class="progress-container">
                <div class="progress-bar" id="progress-final-reject"></div>
            </div>
            <h2>GRACIAS POR PARTICIPAR</h2>
            <p class="final-text" style="color: var(--text-color);">
                Lamentablemente, en esta ocasi√≥n no podemos patrocinarte.
                <br><br>
                ¬°Pero no te desanimes y sigue participando en futuras convocatorias!
            </p>
            <!-- Sin bot√≥n de acci√≥n -->
        </section>

    </div>

    <!-- ======================================= -->
    <!-- == FOOTER FIJO                       == -->
    <!-- ======================================= -->
    <footer>
        <p>Power Labz ¬© 2025. Suplementaci√≥n deportiva de alta calidad.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- 1. Almac√©n de Estado y Datos ---
            const state = {
                currentScreen: 'welcome',
                currentBenefit: 0,
                currentFormStep: 0,
                formData: {},
                isAccepted: false // N U E V O: Estado de aceptaci√≥n
            };

            const benefitMessages = [
                "<strong>Suplementos Gratis</strong> ‚Äì Recibir√°s 1 o 2 productos al mes sin costo, √∫nicamente pagas el env√≠o.",
                "<strong>Precio de Atleta</strong> ‚Äì Acceso a precios especiales en todo nuestro cat√°logo de productos.",
                "<strong>9 Meses de Patrocinio</strong> ‚Äì Un contrato de 9 meses que asegura tu permanencia y beneficios con la marca.",
                "<strong>Oportunidad de Distribuidor</strong> ‚Äì Posibilidad de convertirte en distribuidor y generar ingresos extra.",
                "<strong>Menci√≥n en Redes</strong> ‚Äì Debes mencionarnos y promocionarnos en nuestras redes sociales, incluyendo historias y publicaciones.",
                "<strong>Menci√≥n en Historias</strong> ‚Äì Debes mencionarnos en historias con nuestros productos en redes sociales.",
                "<strong>Etiquetas y Contenido</strong> ‚Äì Comparte contenido, etiqu√©tanos y tu publicaci√≥n podr√≠a ser destacada en nuestro perfil."
            ];
            
            const formSteps = [
                {
                    id: 'name',
                    label: '¬øC√≥mo te llamas?',
                    icon: 'üë§',
                    type: 'text',
                    placeholder: 'Tu nombre completo',
                    validation: (val) => val.trim() !== '',
                    error: 'Por favor, dinos tu nombre.'
                },
                {
                    id: 'age',
                    label: '¬øCu√°ntos a√±os tienes?',
                    icon: 'üéÇ',
                    type: 'number',
                    placeholder: 'Ej: 25',
                    validation: (val) => /^\d+$/.test(val) && parseInt(val, 10) > 0,
                    error: 'Por favor, ingresa una edad v√°lida.'
                    // L√≥gica de rechazo movida al final
                },
                {
                    id: 'city',
                    label: '¬øEn qu√© ciudad est√°s?',
                    icon: 'üìç',
                    type: 'text',
                    placeholder: 'Ej: Ciudad de M√©xico',
                    validation: (val) => val.trim() !== '',
                    error: 'Por favor, dinos tu ciudad.'
                },
                {
                    id: 'instagram',
                    label: '¬øCu√°l es tu usuario de Instagram?',
                    icon: 'üì±',
                    type: 'text',
                    placeholder: '@tuusuario',
                    validation: (val) => val.trim() !== '',
                    error: 'Por favor, ingresa tu usuario de Instagram.'
                },
                {
                    id: 'training',
                    label: '¬øCu√°nto tiempo llevas entrenando?',
                    icon: 'üèãÔ∏è',
                    type: 'select',
                    options: ['Menos de 6 meses', '6 meses', '9 meses', '1 a√±o', '1-3 a√±os', '3-6 a√±os', 'M√°s de 6 a√±os'],
                    validation: (val) => val !== '',
                    error: 'Por favor, selecciona una opci√≥n.'
                },
                {
                    id: 'supplements',
                    label: '¬øUsas suplementos deportivos?',
                    icon: 'üíä',
                    type: 'select',
                    options: ['S√≠', 'No'],
                    validation: (val) => val !== '',
                    error: 'Por favor, selecciona una opci√≥n.'
                },
                {
                    id: 'supplementsWhich',
                    label: '¬øCu√°les consumes?',
                    icon: 'üíä',
                    type: 'text',
                    placeholder: 'Ej: Prote√≠na, creatina...',
                    validation: (val) => val.trim() !== '',
                    error: 'Por favor, dinos qu√© suplementos consumes.',
                    dependsOn: { id: 'supplements', value: 'S√≠' } 
                },
                {
                    id: 'sponsorship',
                    label: '¬øTe ha patrocinado otra marca antes?',
                    icon: 'ü§ù',
                    type: 'select',
                    options: ['S√≠', 'No'],
                    validation: (val) => val !== '',
                    error: 'Por favor, selecciona una opci√≥n.'
                },
                {
                    id: 'currentSponsorship',
                    label: '¬øCuentas con el patrocinio ahora mismo?',
                    icon: 'ü§ù',
                    type: 'select',
                    options: ['S√≠', 'No'],
                    validation: (val) => val !== '',
                    error: 'Por favor, selecciona una opci√≥n.',
                    dependsOn: { id: 'sponsorship', value: 'S√≠' }
                }
            ];

            const mainWhatsAppNumber = '5215629554857';

            // --- 2. Selectores del DOM ---
            const screens = document.querySelectorAll('.screen');
            const startBtn = document.getElementById('start-btn');
            const nextBenefitBtn = document.getElementById('next-benefit-btn');
            const formNextBtn = document.getElementById('form-next-btn');
            const whatsappBtn = document.getElementById('whatsapp-btn');
            
            const formLabel = document.getElementById('form-step-label');
            const formInputContainer = document.getElementById('form-step-input-container');
            const stepValidation = document.getElementById('step-validation');

            const progressBars = {
                benefits: document.getElementById('progress-benefits'),
                form: document.getElementById('progress-form'),
                finalAccept: document.getElementById('progress-final-accept'),
                finalReject: document.getElementById('progress-final-reject')
            };
            

            // --- 3. Funciones Principales ---

            function navigateTo(screenId) {
                screens.forEach(screen => screen.classList.remove('active'));
                const targetScreen = document.getElementById(screenId);
                if (targetScreen) targetScreen.classList.add('active');
                state.currentScreen = screenId;
                window.scrollTo(0, 0);
            }

            function updateProgress(screenKey, width) {
                if (progressBars[screenKey]) {
                    progressBars[screenKey].style.width = width;
                }
            }

            function showBenefit(index) {
                const benefitTextEl = document.getElementById('benefit-text');
                if (benefitTextEl) {
                    benefitTextEl.style.opacity = '0';
                    setTimeout(() => {
                        benefitTextEl.innerHTML = benefitMessages[index];
                        benefitTextEl.style.opacity = '1';
                    }, 300);
                }
            }
            
            function renderCurrentFormStep() {
                stepValidation.textContent = '';
                
                let step = formSteps[state.currentFormStep];

                if (step.dependsOn) {
                    const parentValue = state.formData[step.dependsOn.id];
                    if (parentValue !== step.dependsOn.value) {
                        // Rellenar con N/A y saltar
                        state.formData[step.id] = 'N/A';
                        state.currentFormStep++;
                        if (state.currentFormStep >= formSteps.length) {
                            evaluateAndTransition();
                        } else {
                            renderCurrentFormStep();
                        }
                        return;
                    }
                }

                formLabel.innerHTML = `<span class="label-icon">${step.icon}</span> ${step.label}`;
                let inputHtml = '';
                
                switch(step.type) {
                    case 'text':
                    case 'number':
                        inputHtml = `<input type="${step.type}" id="step-${step.id}" placeholder="${step.placeholder}" value="">`;
                        break;
                    case 'select':
                        let optionsHtml = '<option value="" disabled selected>Por favor, selecciona algo</option>';
                        optionsHtml += step.options.map(opt => `<option value="${opt}">${opt}</option>`).join('');
                        inputHtml = `<select id="step-${step.id}">${optionsHtml}</select>`;
                        break;
                }
                formInputContainer.innerHTML = inputHtml;

                const inputElement = document.getElementById(`step-${step.id}`);
                if (state.formData[step.id] && state.formData[step.id] !== 'N/A') {
                    inputElement.value = state.formData[step.id];
                }

                if (step.type === 'select') {
                    if (inputElement.value) {
                        inputElement.classList.add('has-value');
                    }
                    inputElement.addEventListener('change', () => {
                        inputElement.classList.toggle('has-value', !!inputElement.value);
                    });
                }

                if (state.currentFormStep === formSteps.length - 1) {
                    formNextBtn.textContent = 'Finalizar';
                } else {
                    formNextBtn.textContent = 'Siguiente';
                }
            }
            
            function validateAndAdvance() {
                let step = formSteps[state.currentFormStep];
                const inputElement = document.getElementById(`step-${step.id}`);
                const value = inputElement.value;

                // Validaci√≥n de campo requerido
                if (!step.validation(value)) {
                    stepValidation.textContent = step.error;
                    return;
                }
                
                // Validaci√≥n exitosa
                stepValidation.textContent = '';
                state.formData[step.id] = value;
                state.currentFormStep++;

                updateProgress('form', `66%`); // Mantener en 66%
                
                if (state.currentFormStep >= formSteps.length) {
                    evaluateAndTransition();
                } else {
                    renderCurrentFormStep();
                }
            }
            
            // N U E V O: Eval√∫a al final y transiciona a Aceptado o Rechazado
            function evaluateAndTransition() {
                // Por defecto, aceptado
                let isAccepted = true;
                
                // Aplicar reglas de rechazo
                if (parseInt(state.formData.age, 10) <= 18) {
                    isAccepted = false;
                }
                if (state.formData.training === 'Menos de 6 meses') {
                    isAccepted = false;
                }
                if (state.formData.supplements === 'No') {
                    isAccepted = false;
                }
                // Si dijo 'S√≠' a patrocinio y 'S√≠' a patrocinio actual
                if (state.formData.sponsorship === 'S√≠' && state.formData.currentSponsorship === 'S√≠') {
                    isAccepted = false;
                }
                
                state.isAccepted = isAccepted;

                if (state.isAccepted) {
                    // --- ACEPTADO ---
                    navigateTo('final-screen');
                    updateProgress('finalAccept', '100%');
                    document.getElementById('current-date-span').textContent = new Date().toLocaleDateString('es-MX', { year: 'numeric', month: 'long', day: 'numeric' });
                } else {
                    // --- RECHAZADO ---
                    navigateTo('rejection-screen');
                    updateProgress('finalReject', '100%');
                }
            }

            function sendWhatsAppMessage() {
                const today = new Date().toLocaleDateString('es-MX');
                const data = state.formData;

                // N U E V O: Mensaje con Emojis
                let message = `¬°Hola Power Labz! üèãÔ∏è‚Äç‚ôÇÔ∏è Quiero unirme al CREW.\n\n`;
                message += `--- üìã DATOS DE REGISTRO ---\n`;
                message += `üóìÔ∏è Fecha: ${today}\n`;
                message += `üë§ Nombre: ${data.name || 'N/A'}\n`;
                message += `üéÇ Edad: ${data.age || 'N/A'}\n`;
                message += `üìç Ciudad: ${data.city || 'N/A'}\n`;
                message += `üì± Instagram: ${data.instagram || 'N/A'}\n`;
                message += `üí™ Tiempo Entrenando: ${data.training || 'N/A'}\n`;
                message += `üíä Usa Suplementos: ${data.supplements || 'N/A'}\n`;
                
                if (data.supplements === 'S√≠') {
                    message += `   ‚û°Ô∏è Consume: ${data.supplementsWhich || 'N/A'}\n`;
                }
                
                message += `ü§ù Patrocinio Previo: ${data.sponsorship || 'N/A'}\n`;
                
                if (data.sponsorship === 'S√≠') {
                    message += `   ‚û°Ô∏è Patrocinio Actual: ${data.currentSponsorship || 'N/A'}\n`;
                }
                
                message += `\n¬°Espero confirmaci√≥n! üöÄ`;
                
                const encodedMessage = encodeURIComponent(message);
                const waLink = `https://wa.me/${mainWhatsAppNumber}?text=${encodedMessage}`;
                
                window.open(waLink, '_blank');
            }

            // --- 4. Event Listeners ---

            startBtn.addEventListener('click', () => {
                navigateTo('benefits-screen');
                updateProgress('benefits', '33%');
                showBenefit(0);
            });

            nextBenefitBtn.addEventListener('click', () => {
                state.currentBenefit++;
                if (state.currentBenefit < benefitMessages.length) {
                    showBenefit(state.currentBenefit);
                } else {
                    navigateTo('form-screen');
                    updateProgress('form', '66%');
                    renderCurrentFormStep();
                }
            });

            formNextBtn.addEventListener('click', validateAndAdvance);
            
            whatsappBtn.addEventListener('click', sendWhatsAppMessage);

        });
    </script>
</body>
</html>